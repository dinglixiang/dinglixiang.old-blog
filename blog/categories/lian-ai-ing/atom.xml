<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: 恋爱ing | Dinglixiang]]></title>
  <link href="http://dinglixiang.github.io/blog/categories/lian-ai-ing/atom.xml" rel="self"/>
  <link href="http://dinglixiang.github.io/"/>
  <updated>2013-04-29T15:29:09+08:00</updated>
  <id>http://dinglixiang.github.io/</id>
  <author>
    <name><![CDATA[Dinglixiang]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[恋爱ing之读取配置信息]]></title>
    <link href="http://dinglixiang.github.io/blog/2013/04/29/lian-ai-ingzhi-du-qu-pei-zhi-xin-xi/"/>
    <updated>2013-04-29T15:18:00+08:00</updated>
    <id>http://dinglixiang.github.io/blog/2013/04/29/lian-ai-ingzhi-du-qu-pei-zhi-xin-xi</id>
    <content type="html"><![CDATA[<blockquote><p>项目github地址：<a href="https://github.com/dinglixiang/Shopping">恋爱ing </a></p>

<p>bootstrap地址：<a href="http://xiemin.me/bootstrap-2.3.0/">Bootstrap</a></p></blockquote>

<p><strong><em>Before：界面引入bootstrap。</em></strong></p>

<p>在本项目中，为了方便快捷，我是将管理员的账号密码等信息放在配置文件<code>web.xml</code>中的。</p>

<p>如在<a href="https://github.com/dinglixiang/Shopping/blob/master/web/WEB-INF/web.xml">web.xml</a>文件中，有以下配置信息：</p>

<pre><code>&lt;context-param&gt;
    &lt;param-name&gt;email&lt;/param-name&gt;
    &lt;param-value&gt;admin@gmail.com&lt;/param-value&gt;
&lt;/context-param&gt;
</code></pre>

<p>那么，怎样读取这个配置账号呢？</p>

<p>◆ 在jsp页面中，可以通过 <code>${initParam.email}</code>直接获取到配置文件的信息并显示在页面上，但是在管理员登录时，我们还要进行信息的比较。</p>

<p>如何在jsp 的&lt;%  %>中获取配置信息呢？</p>

<p>我们可通过 <code>application.getInitParameter("email")</code> 来获取<code>web.xml</code>中的<code>email</code>的值，从而与登录界面传递的值进行比较验证。如：<a href="https://github.com/dinglixiang/Shopping/blob/master/web/AdminValidate.jsp">AdminValidate.jsp</a> 所示。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[恋爱ing之返回顶部、底部]]></title>
    <link href="http://dinglixiang.github.io/blog/2013/04/27/lian-ai-ingzhi-fan-hui-ding-bu-%2C-di-bu/"/>
    <updated>2013-04-27T15:10:00+08:00</updated>
    <id>http://dinglixiang.github.io/blog/2013/04/27/lian-ai-ingzhi-fan-hui-ding-bu-,-di-bu</id>
    <content type="html"><![CDATA[<blockquote><p>项目github地址：<a href="https://github.com/dinglixiang/Shopping">恋爱ing </a></p>

<p>bootstrap地址：<a href="http://xiemin.me/bootstrap-2.3.0/">Bootstrap</a></p></blockquote>

<p>当页面信息过多时，为方便信息的浏览，人性化操作，特加入返回顶部、底部功能。</p>

<p>通过网上搜索，找到如下方法。
以<a href="https://github.com/dinglixiang/Shopping/blob/master/web/FlowerDetails.jsp">FlowerDetails.jsp</a>为例。</p>

<p><strong>1.在<code>&lt;head&gt;&lt;/head&gt;</code>标签中加入如下js脚本，并引入<a href="https://github.com/dinglixiang/Shopping/tree/master/web">js文件</a>：</strong></p>

<pre><code>&lt;script type="text/javascript" src="jquery-1.4.1.js"&gt;&lt;/script&gt;
&lt;style type="text/css"&gt;
    .go{width:47px;height:65px;position:fixed;_position:absolute;_top:expression(eval(document.documentElement.scrollTop+document.documentElement.clientHeight-this.offsetHeight-(parseInt(this.currentStyle.marginTop,10)||200)-(parseInt(this.currentStyle.marginBottom,10)||0)));right:20px;bottom:30%; background-color: lightgoldenrodyellow; background-repeat:no-repeat;}
    .go a{text-indent:999em;width:37px;margin:5px;border:0;overflow:hidden;float:left; cursor:pointer;}
    .go .top{background-position:0 0px;height:22px;background-image: url(./images/a.jpg);}
    .go .feedback{background-position:0 -22px;height:32px}
    .go .bottom{background-position:0 -55px;height:22px;background-image: url(./images/a.jpg);}
    .go .top:hover{background-position:-38px -0px}
    .go .feedback:hover{background-position:-38px -22px }
    .go .bottom:hover{background-position:-38px -55px}
    &lt;/style&gt;
    &lt;script type="text/javascript"&gt;
        $(function () {

            $(".top").click(//定义返回顶部点击向上滚动的动画
            function () {
                $('html,body').animate({ scrollTop: 0 }, 700);
            });
            $(".bottom").click(//定义返回顶部点击向上滚动的动画
            function () {
                $('html,body').animate({ scrollTop: document.body.clientHeight }, 700);

            });

        })
&lt;/script&gt;
</code></pre>

<p><strong>2.在<code>&lt;/body&gt;</code>标签之前加入如下代码：</strong></p>

<pre><code>&lt;div class="go"&gt;
  &lt;a title="返回顶部" class="top"&gt;&lt;/a&gt;
  &lt;a title="返回底部" class="bottom" &gt;&lt;/a&gt;
&lt;/div&gt;
</code></pre>

<p>最后，页面信息过多时，即可查看效果。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[恋爱ing之商品搜索]]></title>
    <link href="http://dinglixiang.github.io/blog/2013/04/27/lian-ai-ingzhi-shang-pin-sou-suo/"/>
    <updated>2013-04-27T15:01:00+08:00</updated>
    <id>http://dinglixiang.github.io/blog/2013/04/27/lian-ai-ingzhi-shang-pin-sou-suo</id>
    <content type="html"><![CDATA[<blockquote><p>项目github地址：<a href="https://github.com/dinglixiang/Shopping">恋爱ing </a></p>

<p>bootstrap地址：<a href="http://xiemin.me/bootstrap-2.3.0/">Bootstrap</a></p></blockquote>

<p><strong><em>Before：界面引入bootstrap。</em></strong></p>

<p>本项目的搜索仅限于模糊搜索。</p>

<p><strong>1.搜索样式表单：</strong></p>

<p>◆<a href="https://github.com/dinglixiang/Shopping/blob/master/web/flowers.jsp">flowers.jsp</a></p>

<pre><code>&lt;form class="navbar-search pull-search" action="SearchResult.jsp"&gt;                                              
 &lt;input type="text" class="search-query" name="condition"&gt;
 &lt;button type="submit" class="btn" &gt;搜索&lt;/button&gt;
&lt;/form&gt;
</code></pre>

<p><strong>2.处理表单数据</strong>
◆<a href="https://github.com/dinglixiang/Shopping/blob/master/web/SearchResult.jsp">SearchResult.jsp</a>，通过javaBean调用<a href="https://github.com/dinglixiang/Shopping/blob/master/src/java/pack/FlowerBean.java">SearchResult方法</a>,调用方法请参考前几篇blog。</p>

<pre><code>//接受搜索条件参数
String condition=request.getParameter("condition");
//通过javaBean调用搜索方法
ArrayList flowers=flower.SearchResult(condition);
//循环输出结果
Iterator iter=flowers.iterator();
......此处省略
</code></pre>

<p>◆调用pack.FlowerBean.java中
<a href="https://github.com/dinglixiang/Shopping/blob/master/src/java/pack/FlowerBean.java">SearchResult方法</a></p>

<pre><code>//模糊查询的sql语句
String strsql="select * from products where product_name like "+"'%"+condition+"%'";
</code></pre>

<p>OK，我就实现了这么一点模糊查询的功能了。后续可能会添加更加强大点的搜索~~~</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[恋爱ing之购买数量的加减]]></title>
    <link href="http://dinglixiang.github.io/blog/2013/04/27/lian-ai-ingzhi-gou-mai-shu-liang-de-jia-jian/"/>
    <updated>2013-04-27T14:52:00+08:00</updated>
    <id>http://dinglixiang.github.io/blog/2013/04/27/lian-ai-ingzhi-gou-mai-shu-liang-de-jia-jian</id>
    <content type="html"><![CDATA[<blockquote><p>项目github地址：<a href="https://github.com/dinglixiang/Shopping">恋爱ing </a></p>

<p>bootstrap地址：<a href="http://xiemin.me/bootstrap-2.3.0/">Bootstrap</a></p></blockquote>

<p><strong><em>Before：界面引入bootstrap。</em></strong></p>

<p>通过js实现购买产品的数量的加减</p>

<p>◆<a href="https://github.com/dinglixiang/Shopping/blob/master/web/flowers.jsp">flowers.jsp</a></p>

<p>jsp加减样式：</p>

<pre><code>&lt;input type="button" class="btn" value="-" onclick="minus(&lt;%=p.getId()%&gt;)"&gt;
&lt;input type="text" class="span1"  value="1" id="&lt;%=p.getId() %&gt;"&gt;
&lt;input type="button"  class="btn" value="+" onclick="plus(&lt;%=p.getId()%&gt;)"&gt;   
</code></pre>

<p>其中<code>p.getId()</code>是在页面展示产品时，循环产品的ArrayList获取的产品的<code>id</code>.</p>

<p>在点击<code>-</code>、<code>+</code>的按钮时，调用<code>minus</code>和<code>plus</code>的方法，且此方法将产品的<code>id</code>作为参数传递。</p>

<pre><code>&lt;script type="text/javascript"&gt;
function minus(id)
{
var count = document.getElementById(id).value;         
document.getElementById(id).value = count-1;
}
&lt;/script&gt;

&lt;script type="text/javascript"&gt;
function plus(id)
{
var number=document.getElementById(id).value;                                      
var cont=parseInt(number)+1;
document.getElementById(id).value = cont;
}
&lt;/script&gt;
</code></pre>

<p>在此简单说下为什么要用产品的id作为text的id，即此句。</p>

<p><code>&lt;input type="text" class="span1"  value="1" id="&lt;%=p.getId() %&gt;"&gt;</code></p>

<p>  其实最开始，我实现数量的加减的时候，id是一个字符串，是不变的，在调用js的方法时，通过计算加减1，但是显示的位置是不对的，总是在第一个产品的数量text框中。后来发现，我在循环输出产品信息的时候，每个产品都有一个数量的text框，而且他们的id名称都是相同的，通过 <code>document.getElementById(id).value = cont;</code>改变文本框value值的时候，也就只能改变第一个产品的数量text文本框中的值。所以，后来就采用了一个动态的<code>id</code>作为传递的值。</p>

<p>  OK，至此，数量的加减操作已经完成了，可以将此值传递到下一个页面进行商品总价的计算了。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[恋爱ing之购买商品销量增加]]></title>
    <link href="http://dinglixiang.github.io/blog/2013/04/27/lian-ai-ingzhi-gou-mai-shang-pin-xiao-liang-zeng-jia/"/>
    <updated>2013-04-27T14:43:00+08:00</updated>
    <id>http://dinglixiang.github.io/blog/2013/04/27/lian-ai-ingzhi-gou-mai-shang-pin-xiao-liang-zeng-jia</id>
    <content type="html"><![CDATA[<blockquote><p>项目github地址：<a href="https://github.com/dinglixiang/Shopping">恋爱ing </a></p>

<p>bootstrap地址：<a href="http://xiemin.me/bootstrap-2.3.0/">Bootstrap</a></p></blockquote>

<p><strong><em>Before：界面引入bootstrap。</em></strong></p>

<p>购买商品，不可避免的有销量这么一说。</p>

<p>◆本项目中在点击商品加入购物车的同时，我也通过<code>session</code>将所购买的商品的数量存放起来。</p>

<p>◆<a href="https://github.com/dinglixiang/Shopping/blob/master/web/MyCar.jsp">MyCar.jsp</a></p>

<pre><code>//加入小车时传递的参数
int id=Integer.parseInt(request.getParameter("id"));
String count=request.getParameter("count");
//设置session，以为可能购买商品的种类不是单一的，所以通过 "count"+id 来区分哪种商品所购买的数量
session.setAttribute("count"+id,count);
</code></pre>

<p><strong>1.在购物车页面，也要通过数量计算商品的总价。</strong></p>

<p>首先定义一个总价的变量：</p>

<pre><code>float totalprice=0;
</code></pre>

<p>此处有循环输出，具体参考 Cart.jsp文件。</p>

<pre><code>//获取到购物车中商品的购买数量
String count=(String)session.getAttribute("count"+(p.getId()));                                
int cnt=Integer.parseInt(count);
</code></pre>

<p>在循环每个购物车的session时，计算总价：</p>

<pre><code>totalprice+=cnt*(p.getPrice()); 
</code></pre>

<p>最后在循环之外将总价显示出来。</p>

<p><strong>2.购买完成之后，商品的销量要增加。</strong></p>

<p>在订单信息页面（<a href="https://github.com/dinglixiang/Shopping/blob/master/web/OrderInfo.jsp">OrderInfo.jsp</a>）,循环过程中更新商品的销量。</p>

<pre><code>//获取属于该商品的购买数量
String count=(String)session.getAttribute("count"+(p.getId()));
int cnt=Integer.parseInt(count);
//更新数据库中的销量信息
product.UpdateSalesById(p.getId(),p.getSales(),cnt);
</code></pre>

<p>同之前调用FindProductById一样，此时调用的<a href="https://github.com/dinglixiang/Shopping/blob/master/src/java/pack/FlowerBean.java">UpdateSalesById方法</a>也是通过JavaBean调用。</p>

<p>至此，商品销量的更新完成了。</p>
]]></content>
  </entry>
  
</feed>
